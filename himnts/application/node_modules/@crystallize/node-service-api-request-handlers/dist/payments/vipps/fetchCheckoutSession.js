"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.fetchVippsCheckoutSession = void 0;
const client_1 = require("./client");
const fetchPayment_1 = require("./fetchPayment");
const fetchVippsCheckoutSession = async (url, credentials) => {
    const client = await (0, client_1.createClient)({
        ...credentials,
        fetchToken: false,
    });
    const cleanUrl = url.replace(`https://${credentials.origin}`, '');
    const session = await client.get(cleanUrl, url);
    if (session.paymentDetails?.state) {
        const payment = await (0, fetchPayment_1.fetchVippsPayment)(session.reference, credentials);
        return {
            session,
            payment,
        };
    }
    return {
        session,
        payment: null,
    };
};
exports.fetchVippsCheckoutSession = fetchVippsCheckoutSession;
//# sourceMappingURL=fetchCheckoutSession.js.map